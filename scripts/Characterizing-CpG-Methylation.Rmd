---
title: "Chacterizing CpG Methylation"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this script, I'll create figures to characterize CpG methylation in my *C. virginica* gonad samples. I will use a list of CpGs with at least 5x coverage in any samples. I'll also calculate relevant statistics for methylation islands.

**MOVE CODE TO ANALYSIS DIRECTORY `2019-03-18-Characterizing-CpG-Methylation` BEFORE PROCEEDING.**

# Session information

```{r}
sessionInfo()
```

# All 10x CpGs

## Import data

### *M. capitata*

#### Sample 1

```{r}
cpgMethylationWGBS1 <- read.delim("../analyses/Characterizing-CpG-Methylation/Meth10.fastp-trim.202003063900_R1_001_bismark_bt2_pe._10x.bedgraph-Mcap", header = FALSE) #Import file with CpG methylation for all loci with 10x coverage
colnames(cpgMethylationWGBS1) <- c("chromosome", "start", "end", "methylation") #Add column names
head(cpgMethylationWGBS1) #Confirm import
```

```{r}
cpgMethylationRRBS1 <- read.delim("../analyses/Characterizing-CpG-Methylation/Meth13.fastp-trim.202003062040_R1_001_bismark_bt2_pe_10x.bedgraph-Mcap", header = FALSE) #Import file with CpG methylation for all loci with 10x coverage
colnames(cpgMethylationRRBS1) <- c("chromosome", "start", "end", "methylation") #Add column names
head(cpgMethylationRRBS1) #Confirm import
```

```{r}
cpgMethylationMBD1 <- read.delim("../analyses/Characterizing-CpG-Methylation/Meth16.fastp-trim.202003062412_R1_001_bismark_bt2_pe._10x.bedgraph-Mcap", header = FALSE) #Import file with CpG methylation for all loci with 10x coverage
colnames(cpgMethylationMBD1) <- c("chromosome", "start", "end", "methylation") #Add column names
head(cpgMethylationMBD1) #Confirm import
```

#### Sample 2

#### Sample 3

## Create individual figures for Sample 1

```{r}
hist(x = cpgMethylationWGBS1$methylation, axes = FALSE, xlab = "", ylab = "", main = "", xaxs = "i", yaxs = "i") #Create base plot
axis(side = 1, col = "grey80", at = seq(from = 0, to = 100, by = 10), cex.axis = 1.2) #Add x-axis
mtext(side = 1, text = "Methylation (%)", line = 3, cex = 1.5) #Add x-axis label
axis(side = 2, col = "grey80", las = 2, labels = c("0", "2", "4", "6"), at = c(0, 2e+03, 4e+03, 6e+03), cex.axis = 1.2) #add y-axis
mtext(side = 2, text = "Frequency (x1,000)", line = 2.5, cex = 1.5) #Add y-axis label
```

```{r}
hist(x = cpgMethylationRRBS1$methylation, axes = FALSE, xlab = "", ylab = "", main = "", xaxs = "i", yaxs = "i", ylim = c(0, 12e+05)) #Create base plot
axis(side = 1, col = "grey80", at = seq(from = 0, to = 100, by = 10), cex.axis = 1.2) #Add x-axis
mtext(side = 1, text = "Methylation (%)", line = 3, cex = 1.5) #Add x-axis label
axis(side = 2, col = "grey80", las = 2, labels = c("0", "2", "4", "6", "8", "10", "12"), at = c(0, 2e+05, 4e+05, 6e+05, 8e+05, 10e+05, 12e+05), cex.axis = 1.2) #add y-axis
mtext(side = 2, text = "Frequency (x100,000)", line = 2.5, cex = 1.5) #Add y-axis label
```

```{r}
hist(x = cpgMethylationMBD1$methylation, axes = FALSE, xlab = "", ylab = "", main = "", xaxs = "i", yaxs = "i", ylim = c(0, 4e+03)) #Create base plot
axis(side = 1, col = "grey80", at = seq(from = 0, to = 100, by = 10), cex.axis = 1.2) #Add x-axis
mtext(side = 1, text = "Methylation (%)", line = 3, cex = 1.5) #Add x-axis label
axis(side = 2, col = "grey80", las = 2, labels = c("0", "2", "4"), at = c(0, 2e+03, 4e+03), cex.axis = 1.2) #add y-axis
mtext(side = 2, text = "Frequency (x1,000)", line = 2.5, cex = 1.5) #Add y-axis label
```

TRY THIS: https://www.statmethods.net/graphs/density.html

```{r}
plot(density(cpgMethylationWGBS1$methylation))
plot(density(cpgMethylationRRBS1$methylation))
plot(density(cpgMethylationMBD1$methylation))
```

## Create multipanel figure with all samples

# Methylation island characteristics

## Import data

```{r}
methylationIslands <- read.delim("../analyses/Characterizing-CpG-Methylation/FILE", header = FALSE) #Import methylation island list
colnames(methylationIslands) <- c("chr", "MI.start", "MI.end", "mCpGs", "MI.length") #Add column names
head(methylationIslands) #Confirm file format
```

## Calculate statistics

```{r}
range(methylationIslands$mCpGs) #Calculate the range of the number of mCpGs
median(methylationIslands$mCpGs) #Calculate the median number of mCpGs in an island
```

```{r}
range(methylationIslands$MI.length) #Calculate the range MI length
median(methylationIslands$MI.length) #Calculate the median MI length
```

