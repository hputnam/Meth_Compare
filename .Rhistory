'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_all_TG=methRead(Pact_all_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=5)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
head(meth_Pact_all_TG)
jpeg("../analyses/MethCompare_correlation_Pact_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_all_TG,plot=TRUE)
dev.off()
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=5)
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=5)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
jpeg("../analyses/MethCompare_correlation_Pact_all_TG.jpg", width = 1000, height = 600)
jpeg("../analyses/MethCompare_correlation_Pact_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_all_TG,plot=TRUE)
dev.off()
getCorrelation(meth_Pact_all_TG,plot=TRUE)
#################FILTERING###########################
filtered.myobj.Pact_WvM_TG=filterByCoverage(myobj_Pact_WvM_TG,lo.count=5)
library(methylKit)
Pact_WvM_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
library(methylKit)
Pact_WvM_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_WvM_TG=methRead(Pact_WvM_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_WvM_TG=filterByCoverage(myobj_Pact_WvM_TG,lo.count=5)
#################UNITE##############################
meth_Pact_WvM_TG<-unite(filtered.myobj.Pact_WvM_TG)
nrow(meth_Pact_WvM_TG)
head(meth_Pact_WvM_TG)
jpeg("../analyses/MethCompare_correlation_Pact_WvM_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_WvM_TG,plot=TRUE)
dev.off()
nrow(meth_Pact_WvM_TG)
getCorrelation(meth_Pact_WvM_TG,plot=TRUE)
#calculate diffs
myDiff_Pact_WvM_TG<-calculateDiffMeth(meth_Pact_WvM_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_WvM_TG)
#flat file of myDiff
myDiff_Pact_WvM_TG.db<-makeMethylDB(myDiff_Pact_WvM_TG)
#sig diffs
myDiff_Pact_WvM_TG_50p <- getMethylDiff(myDiff_Pact_WvM_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvM_TG)
#sig diffs
myDiff_Pact_WvM_TG_50p <- getMethylDiff(myDiff_Pact_WvM_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvM_TG)
head(myDiff_Pact_WvM_TG)
tail(myDiff_Pact_WvM_TG)
head(myDiff_50p_WvM_TG.db)
?getMethylDIff
?getMethylDiff
head(myDiff_Pact_WvM_TG)
slots(myDiff_Pact_WvM_TG)
View(myDiff_Pact_WvM_TG)
nrow(myDiff_Pact_WvM_TG)
tail(myDiff_Pact_WvM_TG)
library(methylKit)
Pact_WvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_WvR_TG=methRead(Pact_WvR_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_WvR_TG=filterByCoverage(myobj_Pact_WvR_TG,lo.count=5)
#################UNITE##############################
meth_Pact_WvR_TG<-unite(filtered.myobj.Pact_WvR_TG)
nrow(meth_Pact_WvR_TG)
head(meth_Pact_WvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_WvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_WvR_TG,plot=TRUE)
dev.off()
getCorrelation(meth_Pact_WvR_TG,plot=TRUE)
nrow(meth_Pact_WvR_TG)
nrow(meth_Pact_WvR_TG)
#calculate diffs
myDiff_Pact_WvR_TG<-calculateDiffMeth(meth_Pact_WvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
#calculate diffs
myDiff_Pact_WvR_TG<-calculateDiffMeth(meth_Pact_WvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_WvR_TG)
#sig diffs
myDiff_Pact_WvR_TG_50p <- getMethylDiff(myDiff_Pact_WvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvR_TG)
#sig diffs
myDiff_Pact_WvR_TG_50p <- getMethylDiff(myDiff_Pact_WvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvR_TG_50p)
tail(myDiff_Pact_WvR_TG)
library(methylKit)
Pact_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_MvR_TG=methRead(Pact_MvR_TG.list, sample.id = list("Pact_M_7","Pact_M_8","Pact_M_9","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_MvR_TG=filterByCoverage(myobj_Pact_MvR_TG,lo.count=5)
#################UNITE##############################
meth_Pact_MvR_TG<-unite(filtered.myobj.Pact_MvR_TG)
nrow(meth_Pact_MvR_TG)
head(meth_Pact_MvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_MvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_MvR_TG,plot=TRUE)
dev.off()
jpeg("../analyses/MethCompare_correlation_Pact_MvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_MvR_TG,plot=TRUE)
nrow(meth_Pact_MvR_TG)
#calculate diffs
myDiff_Pact_MvR_TG<-calculateDiffMeth(meth_Pact_MvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
#calculate diffs
myDiff_Pact_MvR_TG<-calculateDiffMeth(meth_Pact_MvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_MvR_TG)
#flat file of myDiff
myDiff_Pact_MvR_TG.db<-makeMethylDB(myDiff_Pact_MvR_TG)
#sig diffs
myDiff_Pact_MvR_TG_50p <- getMethylDiff(myDiff_Pact_MvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_MvR_TG_50p)
tail(myDiff_Pact_MvR_TG)
library(methylKit)
Pact_WvM_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_WvM_TG=methRead(Pact_WvM_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_WvM_TG=filterByCoverage(myobj_Pact_WvM_TG,lo.count=5)
#################UNITE##############################
meth_Pact_WvM_TG<-unite(filtered.myobj.Pact_WvM_TG)
nrow(meth_Pact_WvM_TG)
#calculate diffs
myDiff_Pact_WvM_TG<-calculateDiffMeth(meth_Pact_WvM_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
#calculate diffs
myDiff_Pact_WvM_TG<-calculateDiffMeth(meth_Pact_WvM_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
#sig diffs
myDiff_Pact_WvM_TG_50p <- getMethylDiff(myDiff_Pact_WvM_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvM_TG_50p)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(dplyr)
emu_md5<-fread("data/all_emu_cov_files_md5sum.txt")
head(emu_md5)
emu_md5<-fread("data/all_emu_cov_files_md5sum.txt", header=F)
head(emu_md5)
gannet_md5<-fread("data/all_031520-TG-bs_files_GANNET_md5sum.txt", header=F)
head(gannet_md5)
join_md5<-left_join(emu_md5,gannet_md5, by = c("V1" = "V1"))
head(join_md5)
View(join_md5)
str_remove(join_md5, "/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/")
library(stringr)
str_remove(join_md5, "/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/")
head(join_md5)
str_remove(join_md5, "[/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/]")
?str_remove
str_remove(join_md5, fixed("/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/"))
head(join_md5)
str_remove(join_md5, "[/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/]","")
str_replace(join_md5, "[/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/]","")
str_replace(join_md5, "/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/","")
head(join_md5)
str_replace(join_md5, fixed("/home/srlab/GitHub/Meth_Compare/data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/"",""))
emu_md5<-fread("data/all_emu_cov_files_md5sum.txt", header=F)
setwd("~/GitHub/Meth_Compare")
emu_md5<-fread("", header=F)
emu_md5<-fread("data/all_emu_cov_files_md5sum.txt", header=F)
emu_md5<-fread("~/GitHub/Meth_Compare/data/all_emu_cov_files_md5sum.txt", header=F)
d5<-fread("~/GitHub/Meth_Compare/data/all_031520-TG-bs_files_GANNET_md5sum.txt", header=F)
join_md5<-left_join(emu_md5,gannet_md5, by = c("V1" = "V1"))
View(join_md5)
library(methylKit)
MC_all_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth10_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth11_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth12_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_all_TG=methRead(MC_all_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
myobj_MC_all_TG=methRead(MC_all_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.MC_all_TG=filterByCoverage(myobj_MC_all_TG,lo.count=5)
nrow(filtered.myobj.MC_all_TG)
#################UNITE##############################
meth_MC_all_TG<-unite(filtered.myobj.MC_all_TG)
nrow(meth_MC_all_TG)
#################FILTERING###########################
filtered.myobj.MC_all_TG=filterByCoverage(myobj_MC_all_TG,lo.count=10)
#################UNITE##############################
meth_MC_all_TG<-unite(filtered.myobj.MC_all_TG)
nrow(meth_MC_all_TG)
#################FILTERING###########################
filtered.myobj.MC_all_TG=filterByCoverage(myobj_MC_all_TG,lo.count=20)
#################UNITE##############################
meth_MC_all_TG<-unite(filtered.myobj.MC_all_TG)
nrow(meth_MC_all_TG)
head(meth_MC_all_TG)
getCorrelation(meth_MC_all_TG,plot=TRUE)
library(methylKit)
Pact_all_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_all_TG=methRead(Pact_all_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=5)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=10)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=20)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
#################FILTERING###########################
filtered.myobj.MC_all_TG=filterByCoverage(myobj_MC_all_TG,lo.count=10)
#################UNITE##############################
meth_MC_all_TG<-unite(filtered.myobj.MC_all_TG)
nrow(meth_MC_all_TG)
head(meth_MC_all_TG)
jpeg("../analyses/MethCompare_correlation_MC_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_all_TG,plot=TRUE)
dev.off()
PCASamples(meth_MC_all_TG)
library(methylKit)
MC_WvM_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth10_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth11_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth12_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov'
)
myobj_MC_WvM_TG=methRead(MC_WvM_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_R_16","Mcap_R_17","Mcap_R_18"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.MC_WvM_TG=filterByCoverage(myobj_MC_WvM_TG,lo.count=10)
#################UNITE##############################
meth_MC_WvM_TG<-unite(filtered.myobj.MC_WvM_TG)
nrow(meth_MC_WvM_TG)
head(meth_MC_WvM_TG)
jpeg("../analyses/MethCompare_correlation_MC_WvM_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_WvM_TG,plot=TRUE)
dev.off()
PCASamples(meth_MC_WvM_TG)
#calculate diffs
myDiff_WvM_TG<-calculateDiffMeth(meth_MC_WvM_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_WvM_TG)
#flat file of myDiff
myDiff_WvM_TG.db<-makeMethylDB(myDiff_WvM_TG)
#sig diffs
myDiff_WvM_TG_20p <- getMethylDiff(myDiff_WvM_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_WvM_TG_20p)
head(myDiff_20p_WvM_TG.db)
library(methylKit)
MC_WvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth10_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth11_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth12_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_WvR_TG=methRead(MC_WvR_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.MC_WvR_TG=filterByCoverage(myobj_MC_WvR_TG,lo.count=10)
#################UNITE##############################
meth_MC_WvR_TG<-unite(filtered.myobj.MC_WvR_TG)
nrow(meth_MC_WvR_TG)
head(meth_MC_WvR_TG)
jpeg("../analyses/MethCompare_correlation_MC_WvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_WvR_TG,plot=TRUE)
dev.off()
PCASamples(meth_MC_WvR_TG)
#calculate diffs
myDiff_WvR_TG<-calculateDiffMeth(meth_MC_WvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_WvR_TG)
#sig diffs
myDiff_WvR_TG_50p <- getMethylDiff(myDiff_WvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_WvR_TG_50p)
#flat file of myDiff
myDiff_50p_WvR_TG.db<-makeMethylDB(myDiff_WvR_TG_50p)
library(methylKit)
MC_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.MC_WvR_TG=filterByCoverage(myobj_MC_WvR_TG,lo.count=10)
#################UNITE##############################
meth_MC_WvR_TG<-unite(filtered.myobj.MC_WvR_TG)
nrow(meth_MC_WvR_TG)
head(meth_MC_WvR_TG)
jpeg("../analyses/MethCompare_correlation_MC_WvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_WvR_TG,plot=TRUE)
dev.off()
library(methylKit)
MC_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
library(methylKit)
MC_WvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth10_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth11_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth12_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_WvR_TG=methRead(MC_WvR_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
library(methylKit)
MC_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-100g/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
getwd()
library(methylKit)
MC_all_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth10_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth11_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth12_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_all_TG=methRead(MC_all_TG.list, sample.id = list("Mcap_W_10","Mcap_W_11","Mcap_W_12","Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
library(methylKit)
MC_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth16_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth17_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/dedup/Meth18_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth13_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth14_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Mcap_tg/nodedup/Meth15_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_MC_MvR_TG=methRead(MC_MvR_TG.list, sample.id = list("Mcap_M_16","Mcap_M_17","Mcap_M_18","Mcap_R_13","Mcap_R_14","Mcap_R_15"), assembly = "Map_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.MC_MvR_TG=filterByCoverage(myobj_MC_MvR_TG,lo.count=10)
#################UNITE##############################
meth_MC_MvR_TG<-unite(filtered.myobj.MC_MvR_TG)
nrow(meth_MC_MvR_TG)
head(meth_MC_MvR_TG)
jpeg("../analyses/MethCompare_correlation_MC_MvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_MvR_TG,plot=TRUE)
dev.off()
PCASamples(meth_MC_MvR_TG)
#calculate diffs
myDiff_MvR_TG<-calculateDiffMeth(meth_MC_MvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_MvR_TG)
#sig diffs
myDiff_MvR_TG_50p <- getMethylDiff(myDiff_MvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_MvR_TG_50p)
library(methylKit)
Pact_all_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_all_TG=methRead(Pact_all_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_all_TG=filterByCoverage(myobj_Pact_all_TG,lo.count=10)
#################UNITE##############################
meth_Pact_all_TG<-unite(filtered.myobj.Pact_all_TG)
nrow(meth_Pact_all_TG)
head(meth_Pact_all_TG)
jpeg("../analyses/MethCompare_correlation_Pact_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_all_TG,plot=TRUE)
dev.off()
jpeg("../analyses/MethCompare_correlation_Pact_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_all_TG,plot=TRUE)
library(methylKit)
Pact_WvM_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_WvM_TG=methRead(Pact_WvM_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_M_7","Pact_M_8","Pact_M_9"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_WvM_TG=filterByCoverage(myobj_Pact_WvM_TG,lo.count=10)
#################UNITE##############################
meth_Pact_WvM_TG<-unite(filtered.myobj.Pact_WvM_TG)
nrow(meth_Pact_WvM_TG)
head(meth_Pact_WvM_TG)
jpeg("../analyses/MethCompare_correlation_Pact_WvM_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_WvM_TG,plot=TRUE)
dev.off()
#calculate diffs
myDiff_Pact_WvM_TG<-calculateDiffMeth(meth_Pact_WvM_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_WvM_TG)
#sig diffs
myDiff_Pact_WvM_TG_50p <- getMethylDiff(myDiff_Pact_WvM_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvM_TG_50p)
tail(myDiff_Pact_WvM_TG)
library(methylKit)
Pact_WvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth1_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth2_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth3_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_WvR_TG=methRead(Pact_WvR_TG.list, sample.id = list("Pact_W_1","Pact_W_2","Pact_W_3","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_WvR_TG=filterByCoverage(myobj_Pact_WvR_TG,lo.count=10)
#################UNITE##############################
meth_Pact_WvR_TG<-unite(filtered.myobj.Pact_WvR_TG)
nrow(meth_Pact_WvR_TG)
head(meth_Pact_WvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_WvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_WvR_TG,plot=TRUE)
dev.off()
#calculate diffs
myDiff_Pact_WvR_TG<-calculateDiffMeth(meth_Pact_WvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_WvR_TG)
#sig diffs
myDiff_Pact_WvR_TG_50p <- getMethylDiff(myDiff_Pact_WvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_WvR_TG_50p)
tail(myDiff_Pact_WvR_TG)
library(methylKit)
Pact_MvR_TG.list=list('../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth7_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth8_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/dedup/Meth9_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth4_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth5_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov',
'../data/gannet.fish.washington.edu/seashell/bu-mox/scrubbed/031520-TG-bs/Pact_tg/nodedup/Meth6_R1_001_val_1_bismark_bt2_pe..CpG_report.merged_CpG_evidence.cov')
myobj_Pact_MvR_TG=methRead(Pact_MvR_TG.list, sample.id = list("Pact_M_7","Pact_M_8","Pact_M_9","Pact_R_4","Pact_R_5","Pact_R_6"), assembly = "Pact_genome", treatment = c(0,0,0,1,1,1), context = "CpG", pipeline = "bismarkCoverage")
#################FILTERING###########################
filtered.myobj.Pact_MvR_TG=filterByCoverage(myobj_Pact_MvR_TG,lo.count=10)
#################UNITE##############################
meth_Pact_MvR_TG<-unite(filtered.myobj.Pact_MvR_TG)
nrow(meth_Pact_MvR_TG)
head(meth_Pact_MvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_MvR_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_MvR_TG,plot=TRUE)
dev.off()
#calculate diffs
myDiff_Pact_MvR_TG<-calculateDiffMeth(meth_Pact_MvR_TG,num.cores = 8,weighted.mean=FALSE,slim=TRUE)
head(myDiff_Pact_MvR_TG)
#sig diffs
myDiff_Pact_MvR_TG_50p <- getMethylDiff(myDiff_Pact_MvR_TG, difference = 50, qvalue = 0.01)
nrow(myDiff_Pact_MvR_TG_50p)
tail(myDiff_Pact_MvR_TG)
getwd()
#################FILTERING###########################
filtered.myobj.Pact_MvR_TG=filterByCoverage(myobj_Pact_MvR_TG,lo.count=10)
#################UNITE##############################
meth_Pact_MvR_TG<-unite(filtered.myobj.Pact_MvR_TG)
nrow(meth_Pact_MvR_TG)
head(meth_Pact_MvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_MvR_TGTESTING.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_MvR_TG,plot=TRUE)
dev.off()
#################FILTERING###########################
filtered.myobj.MC_all_TG=filterByCoverage(myobj_MC_all_TG,lo.count=10)
#################UNITE##############################
meth_MC_all_TG<-unite(filtered.myobj.MC_all_TG)
nrow(meth_MC_all_TG)
head(meth_MC_all_TG)
jpeg("../analyses/MethCompare_correlation_MC_all_TG.jpg", width = 1000, height = 600)
getCorrelation(meth_MC_all_TG,plot=TRUE)
dev.off()
#################FILTERING###########################
filtered.myobj.Pact_MvR_TG=filterByCoverage(myobj_Pact_MvR_TG,lo.count=10)
#################UNITE##############################
meth_Pact_MvR_TG<-unite(filtered.myobj.Pact_MvR_TG)
nrow(meth_Pact_MvR_TG)
head(meth_Pact_MvR_TG)
jpeg("../analyses/MethCompare_correlation_Pact_MvR_TGTESTING.jpg", width = 1000, height = 600)
getCorrelation(meth_Pact_MvR_TG,plot=TRUE)
dev.off()
